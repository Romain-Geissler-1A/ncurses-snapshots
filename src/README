NCURSES 1.8.7 - December 7, 1994
--------------------------------
This file is intended to help people interested in working
on fixing ncurses, enhancing it, or porting it to other
platforms.

PORTABILITY:

To add support for a new operating system, you must add a line for that
system to the `matrix' file.

The field values are listed below.  Down the left side are the operating
systems supported. If an option is not needed then it should have an entry of
NONE.  Note the use of ':' to terminate each field.

NUMBER:		Number by which you select the OS via Configure

OS: 		label of the operating system (used as config file suffix)

OSNAME:		name of the operating system

ISPOSIX:	-DNONPOSIX if <unistd.h> is missing

POSIX:		-DSTRICTPOSIX if _POSIX_SOURCE turns off non-POSIX features.
		-DSVR4_ACTION if like svr4 you need _POSIX_SOURCE to have
		sigaction(2).

TERMINAL:	-DNOTERMIOS if you don't have <termios.h> but have <sgtty.h>

HEADERS:	-DBRAINDEAD if system headers don't declare external variables

TABS:		-DBSDTABS if you don't have TABS3 but have OXTABS

SRCDIR:		the directory where the terminfo database lives

CC:		ANSI C compiler

FLAGS:		standard compiler flags

EXTRA:		extra flags needed by individual systems
	Sun:	-DSUNIOCTL <sys/ioctl.h> conflicts with <termios.h>
	HP-UX:	-D_HPUX_SOURCE so that we get POSIX and XOPEN features.
	SVR4:	-DBROKEN_TIOCGETWINSZ guess what?
	AIX:	-DSYS_SELECT if you need <sys/select.h>

BASE:		The directory under which headers and libraries will
		be installed.

INSTALL:	The name of an install program similar to BSD's (ie. 
		understands -m, -g, -o, etc.).  GNU install works.

The awk script in script.src reads matrix and generates all the Config.*
files. 

There are several problems with strict POSIX systems so extra flags
or #define's maybe needed.

THINGS TO DO:

1. Functions not yet implemented

The following functions have not yet been implemented: filter().

2. COSE conformance

There is a COSE standard under development, COSE 1170, which describes a
superset of the SVr4 API.  We would like to make ncurses conformant.

3. DOS port

Only 16 of the 55 files in the library depend on the terminfo format.
It should be possible to further kernelize the package, then rewrite 
a small number of core files to produce a functionally-compatible
port that would do updates to a memory-mapped screen area.  The first
result of this would be a DOS port.

4. X port

It would be nice if ncurses could recognize when it was running under X and
maintain its own window.  With this feature, all ncurses programs would
automatically become X programs.

ORGANIZATION:

The following notes are intended to be a first step towards DOS and Macintosh
ports of the ncurses library.

The following library modules are `pure curses'; they operate only on the
curses internal structures, do all output through other curses calls (not
including tputs() and putp()) and do not call any other UNIX routines such
as signal(2) or the stdio library.  Thus, they will operate quite happily as
long as cur_term points to a valid terminal capability block, and should not
need to be modified for single-terminal ports.

lib_addch.c
lib_addstr.c
lib_bkgd.c
lib_box.c
lib_clear.c
lib_clrbot.c
lib_clreol.c
lib_delch.c
lib_delwin.c
lib_erase.c
lib_getstr.c	(uses outstr())
lib_inchstr.c
lib_insch.c
lib_insdel.c
lib_insstr.c
lib_keyname.c
lib_move.c
lib_mvwin.c
lib_newwin.c
lib_overlay.c
lib_pad.c
lib_printw.c
lib_refresh.c
lib_scanw.c
lib_scroll.c
lib_scrreg.c
lib_set_term.c
lib_slk.c
lib_touch.c
lib_tparm.c
lib_tputs.c
lib_unctrl.c
lib_window.c

These modules are pure curses, except that they use tputs() and putp():

lib_beep.c
lib_color.c
lib_endwin.c
lib_options.c
lib_vidattr.c

This modules assist in POSIX emulation on non-POSIX systems:

sigaction.c	-- signal calls
strerror.c	-- uses sys_errlist[]; for non-POSIX systems only

The following source files will not be needed for a single-terminal-type port.

captoinfo.c
clear.c
comp_captab.c
comp_error.c
comp_hash.c
comp_main.c
comp_parse.c
comp_scan.c
alloc_entry.c
dump_entry.c
parse_entry.c
write_entry.c
infocmp.c
tput.c

The following modules will use open()/read()/write()/close()/lseek() on files,
but no other OS calls.

lib_screen.c	-- used to read/write screen dumps
lib_trace.c	-- used to write trace data to the logfile
read_entry.c	-- used to read terminfo entries

Modules that would have to be modified for a port start here:

The following modules are `pure curses' but contain assumptions inappropriate
for a memory-mapped port.

lib_longname.c	-- assumes there may be multiple terminals
	longname()		-- return long name of terminal
lib_acs.c	-- assumes acs_map as a double indirection
	init_acs()		-- initialize acs map
lib_mvcur.c	-- assumes cursor moves have variable cost
	mvcur()			-- do physical cursor move
lib_termcap.c	-- assumes there may be multiple terminals
	tgetent()		-- load entry
	tgetflag()		-- get boolean capability
	tgetnum()		-- get numeric capability
	tgetstr()		-- get string capability
lib_ti.c	-- assumes there may be multiple terminals
	tigetent()		-- load entry
	tigetflag()		-- get boolean capability
	tigetnum()		-- get numeric capability
	tigetstr()		-- get string capability

The following modules use UNIX-specific calls:

lib_doupdate.c	-- input checking
	doupdate()		-- repaint real screen to match virtual
	_outch()		-- put out a single character
lib_getch.c	-- read()
	getch()			-- get single character
	ungetch()		-- push back single character
lib_initscr.c	-- getenv()
	initscr()		-- initialize curses functions
lib_newterm.c
	newterm()		-- set up new terminal screen
lib_kernel.c	-- various tty-manipulation and system calls
	reset_prog_mode()	-- reset ccurses-raw mode
	reset_shell_mode()	-- reset cooked mode
	baudrate()		-- return the baudrate
	erasechar()		-- return the erase char
	killchar()		-- return the kill character
	flushinp()		-- flush pending input
	savetty()		-- save tty state
	resetty()		-- reset tty to state at last savetty() 
	input_waiting()		-- check for pending input
lib_raw.c	-- various tty-manipulation calls
	raw()
	echo()
	nl()
	qiflush()
	cbreak()
	noraw()
	noecho()
	nonl()
	noqiflush()
	nocbreak()
lib_setup.c	-- various tty-manipulation calls
	use_env()
	def_shell_mode()
	def_prog_mode()
	set_curterm()
	del_curterm()
lib_tstp.c	-- signal-manipulation calls
	curses_signal_handler()	-- enable/disable window-mode signal catching
lib_twait.c	-- gettimeofday(), select().
	usleep()		-- microsecond sleep
	timed_wait()		-- timed wait for input

The package kernel could be made smaller.
